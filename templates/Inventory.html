{% extends 'base.html' %}

{% block title %}Інвентар{% endblock %}
{% block header_title %}Інвентар{% endblock %}
{% block page_class %}page--inventory{% endblock %}

{% block content %}
<section
    class="inventory"
    data-inventory-root
    data-player-id="{{ user.id if user else '' }}"
    data-current-user-id="{{ user.id if user else '' }}"
    data-lobby-id=""
    data-role="player"
    data-is-master="false"
>
    <div class="inventory-panel panel-secondary">
        <div class="panel-header">
            <span class="panel-title" data-player-name>KING</span>
            <span class="panel-tag" data-player-role>Inventory</span>
        </div>
        <div class="inventory-tabs" role="tablist" aria-label="Режими інвентаря">
            <button class="tab-button is-active" data-tab="equipment" type="button" role="tab">Екіпировка</button>
            <button class="tab-button" data-tab="stats" type="button" role="tab">Stats</button>
        </div>

        <div class="tab-content is-active" data-panel="equipment" role="tabpanel">
            <div class="equipment-board">
                <div class="equipment-board__column">
                    <div class="equipment-group">
                        <span class="equipment-group__label">Head</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_head"></div>
                    </div>
                    <div class="equipment-group">
                        <span class="equipment-group__label">Shirt</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_shirt"></div>
                    </div>
                    <div class="equipment-group">
                        <span class="equipment-group__label">Pants</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_pants"></div>
                    </div>
                </div>
                <div class="equipment-board__column">
                    <div class="equipment-group">
                        <span class="equipment-group__label">Armor</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_armor"></div>
                    </div>
                    <div class="equipment-group">
                        <span class="equipment-group__label">Boots</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_boots"></div>
                    </div>
                    <div class="equipment-group">
                        <span class="equipment-group__label">Amulet</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_amulet"></div>
                    </div>
                </div>
                <div class="equipment-board__column">
                    <div class="equipment-group">
                        <span class="equipment-group__label">Weapon</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_weapon"></div>
                    </div>
                    <div class="equipment-group">
                        <span class="equipment-group__label">Back</span>
                        <div class="tetris-grid tetris-grid--equip" data-container-id="equip_back"></div>
                    </div>
                </div>
            </div>
        </div>

        <div class="tab-content" data-panel="stats" role="tabpanel">
            <div class="stats-grid">
                <div class="stat-card">
                    <span class="stat-card__label">STR</span>
                    <strong>14</strong>
                    <span class="stat-card__mod">+2</span>
                </div>
                <div class="stat-card">
                    <span class="stat-card__label">DEX</span>
                    <strong>12</strong>
                    <span class="stat-card__mod">+1</span>
                </div>
                <div class="stat-card">
                    <span class="stat-card__label">CON</span>
                    <strong>13</strong>
                    <span class="stat-card__mod">+1</span>
                </div>
                <div class="stat-card">
                    <span class="stat-card__label">INT</span>
                    <strong>10</strong>
                    <span class="stat-card__mod">+0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-card__label">WIS</span>
                    <strong>11</strong>
                    <span class="stat-card__mod">+0</span>
                </div>
                <div class="stat-card">
                    <span class="stat-card__label">CHA</span>
                    <strong>16</strong>
                    <span class="stat-card__mod">+3</span>
                </div>
            </div>

            <div class="stats-extra">
                <div class="stat-pill">HP: 38</div>
                <div class="stat-pill">Stamina: 22</div>
                <div class="stat-pill">Mana: 18</div>
                <div class="stat-pill">Armor Class: 15</div>
                <div class="stat-pill">Resistances: fire, poison</div>
                <div class="stat-pill">Carry Capacity: 80</div>
            </div>
        </div>
    </div>

    <div class="inventory-grid-panel panel-main">
        <div class="panel-header">
            <span class="panel-title">INVENTORY</span>
            <span class="panel-tag" data-weight-display>Вага: 0 / 5 kg</span>
        </div>
        <div class="inventory-actions" data-inventory-actions>
            <button class="button ghost" type="button" data-action="auto-pack">Auto-pack</button>
            <button class="button" type="button" data-action="rotate-item">Rotate (R)</button>
        </div>
        <div class="tetris-grid" data-container-id="inv_main" aria-label="Рюкзак"></div>
        <p class="muted inventory-hint">Перетягуйте предмети, натискайте R для повороту та ПКМ для контекстного меню.</p>
    </div>
</section>

<div class="context-menu" id="context-menu" aria-hidden="true">
    <div class="context-menu__header">
        <strong id="context-name">Item</strong>
        <span class="chip" id="context-type">type</span>
        <span class="chip chip--quality" id="context-quality">quality</span>
    </div>
    <p class="context-menu__meta" id="context-size">Розмір: 1×1</p>
    <p class="context-menu__meta" id="context-weight">Вага: 0</p>
    <p class="context-menu__description" id="context-description"></p>
    <div class="context-menu__actions">
        <button class="button ghost" type="button" data-action="use">Use</button>
        <button class="button ghost" type="button" data-action="equip">Equip</button>
        <button class="button ghost" type="button" data-action="rotate">Rotate</button>
        <button class="button ghost" type="button" data-action="split">Split</button>
        <button class="button ghost" type="button" data-action="drop">Drop</button>
        <button class="button" type="button" data-action="transfer">Transfer to…</button>
    </div>
</div>

<div class="transfer-modal" id="transfer-modal" aria-hidden="true">
    <div class="transfer-modal__content">
        <h3>Передати предмет</h3>
        <div class="transfer-modal__players" id="transfer-players"></div>
        <button class="button ghost" type="button" id="transfer-close">Скасувати</button>
    </div>
</div>

<script>
    window.INVENTORY_DATA = {{ inventory_data | tojson }};
    window.TRANSFER_PLAYERS = {{ transfer_players | tojson }};
</script>
<script src="{{ url_for('static', filename='inventory.js') }}" defer></script>
{% endblock %}
